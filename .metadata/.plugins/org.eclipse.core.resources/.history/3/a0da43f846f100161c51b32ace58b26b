<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
	"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="kr.co.mlec.mini5.user.dao.UserDAO">

	<resultMap id="userMap" type="user">
		<result property="no" column="user_no"/>
		<result property="id" column="id"/>
		<result property="pass" column="pass"/>
		<result property="nickName" column="nick_name"/>
		<result property="autoType" column="auto_type"/>
		<result property="profImgPath" column="prof_img_path"/>
		<result property="covrImgPath" column="covr_img_path"/>
		<result property="regDate" column="reg_date"/>
		<result property="modDate" column="mod_date"/>
	</resultMap>

	<!--
		로그인하는 select
	 -->
	<select id="innerLogin" parameterType="user" resultMap="userMap">
		select *
		  from t_user
		 where id = #{id}
		   and pass = #{pass}
	</select>
	<select id="outerLogin" parameterType="string" resultMap="userMap">
		select *
		  from t_user
		 where id = #{id}
	</select>
	
	
	<!-- 
		회원가입 insert
	-->
	<insert id="insertUser" parameterType="user">
		<selectKey keyProperty="no" order="BEFORE" resultType="int">
	        select s_user_user_no.nextVal from dual
	    </selectKey>
		insert into t_user(
			user_no,
			id,
			pass,
			nick_name
		)
		values(
			#{no},
			#{id},
			#{pass},
			#{nickName}
		)
	</insert>
	
	<select id="selectUserIdList" parameterType="string" resultType="string">
		select id 
		  from t_user
		 where id = #{id}
	</select>
	
	<select id="selectSignUp" parameterType="int" resultType="user">
		select *
		  from t_user
		 where user_no = #{no}
	</select>
	
	<select id="selectUserPassList" parameterType="user" resultMap="userMap">
		select id,
			   pass
		  from t_user
		 where id = #{id}
		   	 and pass = #{pass}
		
	</select>
	
	<update id="updateUserPass" parameterType="user">
		update t_user
		   set pass = #{newPass}
		 where id = #{id}
	</update>
	
	
	<!-- 회원정보 조회 -->
	<select id="selectDetail" parameterType="int" resultType="user">
		select *
		  from t_user
		  where user_no = #{no}
	</select>


	<!-- 회원정보 수정 -->
	<update id="updateUserProf" parameterType="user">
		update t_user
		   set <if test="profImgPath != null">
		   	   	prof_img_path = #{profImgPath},
		   	   </if>
		   	   <if test="covrImgPath != null">
		   	   	covr_img_path = #{covrImgPath},
		   	   </if>
		   	   pass = #{pass}
		 where id = #{id}
	</update>	




</mapper>